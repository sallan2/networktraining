<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Session 4 Practical | Network Analysis in R</title>
  <meta name="description" content="network-course" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Session 4 Practical | Network Analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="network-course" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Session 4 Practical | Network Analysis in R" />
  
  <meta name="twitter:description" content="network-course" />
  



<meta name="date" content="2019-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="network-analysis.html"/>
<link rel="next" href="rstudio-cloud.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="include/psyteachr.css" type="text/css" />
<link rel="stylesheet" href="include/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Network Analysis Course</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="starting-with-r.html"><a href="starting-with-r.html"><i class="fa fa-check"></i><b>1</b> Starting with R</a><ul>
<li class="chapter" data-level="1.1" data-path="starting-with-r.html"><a href="starting-with-r.html#overview-1"><i class="fa fa-check"></i><b>1.1</b> Overview</a><ul>
<li class="chapter" data-level="1.1.1" data-path="starting-with-r.html"><a href="starting-with-r.html#what-is-r"><i class="fa fa-check"></i><b>1.1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.1.2" data-path="starting-with-r.html"><a href="starting-with-r.html#how-to-install-base-r"><i class="fa fa-check"></i><b>1.1.2</b> How To Install Base R</a></li>
<li class="chapter" data-level="1.1.3" data-path="starting-with-r.html"><a href="starting-with-r.html#how-to-install-r-studio"><i class="fa fa-check"></i><b>1.1.3</b> How To Install R Studio</a></li>
<li class="chapter" data-level="1.1.4" data-path="starting-with-r.html"><a href="starting-with-r.html#quiz"><i class="fa fa-check"></i><b>1.1.4</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="starting-with-r.html"><a href="starting-with-r.html#where-to-get-help"><i class="fa fa-check"></i><b>1.2</b> Where to Get Help</a><ul>
<li class="chapter" data-level="1.2.1" data-path="starting-with-r.html"><a href="starting-with-r.html#google"><i class="fa fa-check"></i><b>1.2.1</b> Google</a></li>
<li class="chapter" data-level="1.2.2" data-path="starting-with-r.html"><a href="starting-with-r.html#stackoverflow"><i class="fa fa-check"></i><b>1.2.2</b> Stackoverflow</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="working-with-data-in-r.html"><a href="working-with-data-in-r.html"><i class="fa fa-check"></i><b>2</b> Working With Data in R</a><ul>
<li class="chapter" data-level="2.1" data-path="working-with-data-in-r.html"><a href="working-with-data-in-r.html#overview-2"><i class="fa fa-check"></i><b>2.1</b> Overview</a><ul>
<li class="chapter" data-level="2.1.1" data-path="working-with-data-in-r.html"><a href="working-with-data-in-r.html#setting-working-directory"><i class="fa fa-check"></i><b>2.1.1</b> Setting Working Directory</a></li>
<li class="chapter" data-level="2.1.2" data-path="working-with-data-in-r.html"><a href="working-with-data-in-r.html#code"><i class="fa fa-check"></i><b>2.1.2</b> Code</a></li>
<li class="chapter" data-level="2.1.3" data-path="working-with-data-in-r.html"><a href="working-with-data-in-r.html#functions-arguments"><i class="fa fa-check"></i><b>2.1.3</b> Functions &amp; Arguments</a></li>
<li class="chapter" data-level="2.1.4" data-path="working-with-data-in-r.html"><a href="working-with-data-in-r.html#tidyverse"><i class="fa fa-check"></i><b>2.1.4</b> Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="working-with-data-in-r.html"><a href="working-with-data-in-r.html#scripts"><i class="fa fa-check"></i><b>2.2</b> Scripts</a><ul>
<li class="chapter" data-level="2.2.1" data-path="working-with-data-in-r.html"><a href="working-with-data-in-r.html#opening-spss-files"><i class="fa fa-check"></i><b>2.2.1</b> Opening SPSS Files</a></li>
<li class="chapter" data-level="2.2.2" data-path="working-with-data-in-r.html"><a href="working-with-data-in-r.html#keeping-environment-clean"><i class="fa fa-check"></i><b>2.2.2</b> Keeping Environment Clean</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="network-analysis.html"><a href="network-analysis.html"><i class="fa fa-check"></i><b>3</b> Network Analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="network-analysis.html"><a href="network-analysis.html#overview-3"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="network-analysis.html"><a href="network-analysis.html#background"><i class="fa fa-check"></i><b>3.2</b> Background</a></li>
<li class="chapter" data-level="3.3" data-path="network-analysis.html"><a href="network-analysis.html#why-use-network-analysis-in-mental-health"><i class="fa fa-check"></i><b>3.3</b> Why Use Network Analysis in Mental Health?</a></li>
<li class="chapter" data-level="3.4" data-path="network-analysis.html"><a href="network-analysis.html#what-is-a-network"><i class="fa fa-check"></i><b>3.4</b> What is a network?</a></li>
<li class="chapter" data-level="3.5" data-path="network-analysis.html"><a href="network-analysis.html#drawing-matrices"><i class="fa fa-check"></i><b>3.5</b> Drawing Matrices</a></li>
<li class="chapter" data-level="3.6" data-path="network-analysis.html"><a href="network-analysis.html#understanding-network-plots"><i class="fa fa-check"></i><b>3.6</b> Understanding Network plots</a></li>
<li class="chapter" data-level="3.7" data-path="network-analysis.html"><a href="network-analysis.html#task"><i class="fa fa-check"></i><b>3.7</b> Task</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practical.html"><a href="practical.html"><i class="fa fa-check"></i><b>4</b> Practical</a><ul>
<li class="chapter" data-level="4.1" data-path="practical.html"><a href="practical.html#description-of-data"><i class="fa fa-check"></i><b>4.1</b> Description of Data</a></li>
<li class="chapter" data-level="4.2" data-path="practical.html"><a href="practical.html#visualising-data"><i class="fa fa-check"></i><b>4.2</b> Visualising Data</a></li>
<li class="chapter" data-level="4.3" data-path="practical.html"><a href="practical.html#visualising-data---practical"><i class="fa fa-check"></i><b>4.3</b> Visualising Data - Practical</a></li>
<li class="chapter" data-level="4.4" data-path="practical.html"><a href="practical.html#working-with-data"><i class="fa fa-check"></i><b>4.4</b> Working With Data</a></li>
<li class="chapter" data-level="4.5" data-path="practical.html"><a href="practical.html#plotting-data"><i class="fa fa-check"></i><b>4.5</b> Plotting Data</a></li>
<li class="chapter" data-level="4.6" data-path="practical.html"><a href="practical.html#recoding-factors"><i class="fa fa-check"></i><b>4.6</b> Recoding Factors</a></li>
<li class="chapter" data-level="4.7" data-path="practical.html"><a href="practical.html#simple-network"><i class="fa fa-check"></i><b>4.7</b> Simple Network</a></li>
<li class="chapter" data-level="4.8" data-path="practical.html"><a href="practical.html#interpretation"><i class="fa fa-check"></i><b>4.8</b> Interpretation</a></li>
<li class="chapter" data-level="4.9" data-path="practical.html"><a href="practical.html#assumptions"><i class="fa fa-check"></i><b>4.9</b> Assumptions</a></li>
<li class="chapter" data-level="4.10" data-path="practical.html"><a href="practical.html#stability"><i class="fa fa-check"></i><b>4.10</b> Stability</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="rstudio-cloud.html"><a href="rstudio-cloud.html"><i class="fa fa-check"></i><b>A</b> RStudio Cloud</a><ul>
<li class="chapter" data-level="A.1" data-path="rstudio-cloud.html"><a href="rstudio-cloud.html#creating-an-account"><i class="fa fa-check"></i><b>A.1</b> Creating an Account</a></li>
<li class="chapter" data-level="A.2" data-path="rstudio-cloud.html"><a href="rstudio-cloud.html#accessing-rstudio-cloud"><i class="fa fa-check"></i><b>A.2</b> Accessing RStudio Cloud</a></li>
<li class="chapter" data-level="A.3" data-path="rstudio-cloud.html"><a href="rstudio-cloud.html#getting-started-with-rstudio-cloud"><i class="fa fa-check"></i><b>A.3</b> Getting Started with RStudio Cloud</a><ul>
<li class="chapter" data-level="A.3.1" data-path="rstudio-cloud.html"><a href="rstudio-cloud.html#naming-the-workspace"><i class="fa fa-check"></i><b>A.3.1</b> Naming the Workspace</a></li>
<li class="chapter" data-level="A.3.2" data-path="rstudio-cloud.html"><a href="rstudio-cloud.html#uploading-files"><i class="fa fa-check"></i><b>A.3.2</b> Uploading Files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>B</b> References</a></li>
<li class="divider"></li>
<li><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" 
    target="blank"><img alt="Creative Commons License" 
    style="border-width:0" 
    src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><li>
<li><a href="https://psyteachr.github.io/" target="blank">Based on PsyTeachR</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Network Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="practical" class="section level1">
<h1><span class="header-section-number">Session 4</span> Practical</h1>
<p><strong>In this session you will learn:</strong></p>
<ol style="list-style-type: decimal">
<li>How to work with original data</li>
<li>How to define factors</li>
<li>How to wrangle data</li>
<li>How to visualise data</li>
<li>How to run a simple network analysis.</li>
</ol>
<div id="description-of-data" class="section level2">
<h2><span class="header-section-number">4.1</span> Description of Data</h2>
<p>We will work with a local dataset gathered from high school age children. Please download the .csv file <a href="data/networkdataset.csv">HERE</a> (you might need to right click and choose save as).</p>
<p>First, we need to make sure we have <code>tidyverse</code> loaded and then open the file. We are creating a data frame called which we will assign to our .csv file.</p>
<p>Remember, this needs to be saved within the working directory that you set so that R knows where to find it.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">library</span>(bootnet)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw">library</span>(qgraph)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw">library</span>(summarytools)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;networkdataset.csv&quot;</span>)</a></code></pre></div>
<p>R has the <code>str()</code> function which lets us look at the structure of data. Look at <code>str(data)</code></p>
<p>As we can see, Gender, Place and Grade are listed as character data (words), this is not accurate and it would be better to let R know these data are factors.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">data_factors &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gender =</span> <span class="kw">as.factor</span>(Gender),</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">         <span class="dt">Place =</span> <span class="kw">as.factor</span>(Place),</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">         <span class="dt">Grade =</span> <span class="kw">as.factor</span>(Grade),</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">         <span class="dt">Familyarrangement =</span> <span class="kw">as.factor</span>(Familyarrangement),</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">         <span class="dt">Average =</span> <span class="kw">as.factor</span>(Average),</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">         <span class="dt">educationFather =</span> <span class="kw">as.factor</span>(educationFather),</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">         <span class="dt">educationMather =</span> <span class="kw">as.factor</span>(educationMather))</a></code></pre></div>
<p>Now, if we run <code>str(data_factors)</code> we can see that this dataframe is recognised as factors.</p>
</div>
<div id="visualising-data" class="section level2">
<h2><span class="header-section-number">4.2</span> Visualising Data</h2>
<p>To do - write a bit about plotting options in R.</p>
</div>
<div id="visualising-data---practical" class="section level2">
<h2><span class="header-section-number">4.3</span> Visualising Data - Practical</h2>
<p>How many females and males?</p>
<p>The # symbol in the code is a comment. Comments do not add anything to the code but are there for human understanding to explain what is happening in the code. Look at the comments in the code below to understand what is going on.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># we are telling R we want to plot dat, we are letting R know Gender </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co"># is a factor on our x axis and we want to fill with colour</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">ggplot</span>(data_factors, <span class="kw">aes</span>(<span class="dt">x =</span> Gender, <span class="dt">fill =</span> Gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">  </span><span class="co"># we are choosing a bar plot</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">alpha =</span> <span class="fl">.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="st">  </span><span class="co"># we are naming the x scale</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="st">  </span><span class="co"># we are chosing a colour scheme from pre-exising options</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="st">  </span><span class="co"># we are naming the y scale</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Number of participants&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:graph"></span>
<img src="04-s01-lab02a_files/figure-html/graph-1.png" alt="Participant Gender" width="100%" />
<p class="caption">
Figure 4.1: Participant Gender
</p>
</div>
</div>
<div id="working-with-data" class="section level2">
<h2><span class="header-section-number">4.4</span> Working With Data</h2>
<p>Participants rated themselves on 23 items of the TEQ questionnaire which asked about exposure to different traumatic events. We would like to create a plot to visualise the total TEQ and where participants live. However, we need to clean the data a little bit first. We will explain each line in the code below.</p>
<p>The pipe operator %&gt;% is something you will see a lot and (in terms of code) means “and then”</p>
<ol style="list-style-type: decimal">
<li>we create a new dataframe called <code>total_TEQ</code> which we assign to our new code</li>
<li>we then use <code>select</code>, the . lets R know we are still working with the same dataframe. We then select all TEQ variables, Pcode and Place <code>select(., TEQ1:TEQ23, Pcode, Place</code></li>
<li><code>gather</code> tranforms the data from wide to long. We only want it to do this to TEQ variables so we can drop <code>-Pcode</code> and <code>-Place</code> using the minus sign.</li>
<li>We then use <code>group_by(Pcode, Place)</code> as we want to look at scores for each participant and where they live</li>
<li>Finally <code>summarise(tot_TEQ = sum(score))</code> creates a column named tot_TEQ which has the total TEQ score for each participant.</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">total_TEQ &lt;-<span class="st"> </span>data_factors <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw">select</span>(., TEQ1<span class="op">:</span>TEQ23, Pcode, Place) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw">gather</span>(<span class="st">&quot;var&quot;</span>, <span class="st">&quot;score&quot;</span>, <span class="op">-</span>Pcode, <span class="op">-</span>Place) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="kw">group_by</span>(Pcode, Place) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="kw">summarise</span>(<span class="dt">tot_TEQ =</span> <span class="kw">sum</span>(score))</a></code></pre></div>
</div>
<div id="plotting-data" class="section level2">
<h2><span class="header-section-number">4.5</span> Plotting Data</h2>
<p>Now we can visualise <code>total_TEQ</code>.</p>
<p>When visualising differences between groups in numerical values, people have historically used bar graphs. There is currently a shift taking place, with people moving away from bar graphs, and towards more informative visualisations.</p>
<p>Before we used <code>geom_bar()</code> to create a barplot and this time we will use <code>geom_violin()</code> to create a violin plot. In the violin plot, the width of the area indicates the density of the data at that point on the y axis. We have also included a box plot using <code>geom_boxplot</code> within this graph to show another option.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">ggplot</span>(total_TEQ, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.factor</span>(Place), <span class="dt">fill =</span> <span class="kw">as.factor</span>(Place), <span class="dt">y =</span> tot_TEQ)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_violin</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">trim =</span> <span class="ot">TRUE</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Total TEQ&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Place&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:graph2"></span>
<img src="04-s01-lab02a_files/figure-html/graph2-1.png" alt="TEQ Scores" width="100%" />
<p class="caption">
Figure 4.2: TEQ Scores
</p>
</div>
<p>From looking at the graph we just created, what location tends to have highest TEQ?</p>
<p><select class='solveme' data-answer='["Camp"]'> <option></option> <option>Village</option> <option>Camp</option> <option>City</option></select></p>
</div>
<div id="recoding-factors" class="section level2">
<h2><span class="header-section-number">4.6</span> Recoding Factors</h2>
<p>The original file has Camp, city, Village. It might be neater to have Camp, City, Village. We can easily recode the city level of the Place factor using the following code.</p>
<p>If you re-run the code for the graph now, this should be updated.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">total_TEQ &lt;-<span class="st"> </span>total_TEQ <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Place =</span> <span class="kw">recode</span>(Place, <span class="dt">city =</span> <span class="st">&quot;City&quot;</span>))</a></code></pre></div>
</div>
<div id="simple-network" class="section level2">
<h2><span class="header-section-number">4.7</span> Simple Network</h2>
<p>When creating a network, it is important to think about how complex it will be. The higher the number of nodes being examined, then the higher the number of edges have to be estimated. Too many nodes results in networks that are unstable.</p>
<p>In this example, we will create a simple network from the single question items of the PAQ (Parental Authority Questionnaire).</p>
<p>First, we will select the PAQ items from data_factors:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">PAQ &lt;-<span class="st"> </span>data_factors <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(PAQ1<span class="op">:</span>PAQ12)</a></code></pre></div>
<p>Like all statistical techniques that use sample data to estimate parameters, the correlation and partial correlations values will be influenced by sampling variations and exact zeros will be rarely observed in the matrices. Consequently, correlation networks will nearly always be fully connected networks, possibly with small weights on many of the edges that reflect weak and potentially spurious partial correlations.</p>
<p>Spurious relationships will be problematic in terms of the network interpretation and will compromise the potential for network replication. In order to limit the number of such spurious relationships, a statistical regularisation technique, which takes into account the model complexity, is frequently used.</p>
<p>The LASSO regularisation yields a more parsimonious network (fewer connections between nodes), assumed to reflect only the most “important” empirical relationships in the data. The LASSO utilizes a tuning parameter λ (lambda) that controls the level of sparsity. The tuning parameter directly controls how much the likelihood is penalized for the sum of absolute parameter values. When the tuning parameter is low, only a few edges are removed, likely resulting in the retention of spurious edges. When the tuning parameter is high, many edges are removed, likely resulting in the removal of true edges in addition to the removal of spurious edges. EBICglasso sets a tuning parameter of 0.5 by default.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">Network &lt;-<span class="st"> </span><span class="kw">estimateNetwork</span>(PAQ, <span class="dt">default =</span> <span class="st">&quot;EBICglasso&quot;</span>, <span class="dt">corMethod =</span> <span class="st">&quot;cor_auto&quot;</span>)</a></code></pre></div>
<p>The size and density of the edges between the nodes respresent the strength of connectedness. Positively related nodes are shown in <span style="color:blue"> blue</span> and negatively related nodes are shown in <span style="color:red">red</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">plot</span>(Network, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">labels=</span><span class="kw">colnames</span>(PAQ))</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Plotting"></span>
<img src="04-s01-lab02a_files/figure-html/Plotting-1.png" alt="PAQ Network Graph" width="100%" />
<p class="caption">
Figure 4.3: PAQ Network Graph
</p>
</div>
</div>
<div id="interpretation" class="section level2">
<h2><span class="header-section-number">4.8</span> Interpretation</h2>
<p>The network shows the strength of relationships between the TPB variables. Some variables have quite strong connections (e.g. PAQ12 and PAQ11), whereas others have weak relationship (e.g. PAQ 7 and PAQ3). Visual inspection of the network suggests that some variables may be related. However, visual inspection of the graphical display of complex relationships requires careful interpretation, especially if there are a large number of nodes in the network.</p>
<p>A key concept in network analysis is the centrality of the symptom: if a behaviour or symptom (e.g. fatigue) has many and/or strong associations to other nodes, they are more central within the network than a less connected symptom.There are different centrality metrics, and <em>strength</em> most often used. Expected influence is related to strength but argued to be a <a href="https://psych-networks.com/expected-influence-new-centrality-metric-robinaugh-et-al-2016/">better metric</a> - adapted from open source materials by <a href="https://derekdebeurs.github.io/esssb17/">Derek DeBuers</a></p>
<p>From looking at both strength and expected influence, it appears PAQ12 and PAQ8 have the strongest influence on the nodes in the network. How might we interpret this? Network analysis is purely statistical, the measurement and inclusion of nodes depend on your theory / research question.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">centralityPlot</span>(Network, <span class="dt">include =</span> <span class="kw">c</span>(<span class="st">&quot;Strength&quot;</span>,<span class="st">&quot;ExpectedInfluence&quot;</span>),</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">               <span class="dt">orderBy =</span> <span class="st">&quot;ExpectedInfluence&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Pcentrality"></span>
<img src="04-s01-lab02a_files/figure-html/Pcentrality-1.png" alt="Centrality Plot" width="100%" />
<p class="caption">
Figure 4.4: Centrality Plot
</p>
</div>
</div>
<div id="assumptions" class="section level2">
<h2><span class="header-section-number">4.9</span> Assumptions</h2>
<p>Network Analysis assumes normally disturbuted data which can be rare in psychology where Likert scales (such as that used to measure data here) are common.</p>
<p>“our data did not meet all assumptions of multivariate normality. This is not unusual in psychology, but as it is unclear at present how robust the employed methods are to such violations, results need to be interpreted with caution.” <a href="https://openaccess.leidenuniv.nl/bitstream/handle/1887/73951/Aalbers_et_al_2018_T.pdf?sequence=1">(Aalbers, 2019)</a></p>
</div>
<div id="stability" class="section level2">
<h2><span class="header-section-number">4.10</span> Stability</h2>
<p>When are estimating networks, we are estimating a structure. While we end up with a model, there is uncertainty about model parameters. Researchers in Amsterdam have developed a bootstrapping procedure so we can estimate stability with more confidence. For more information on this, please see <a href="https://psych-networks.com/r-tutorial-power-issues-robustness-network-models/">a tutorial</a> by Eiko Fried.</p>

</div>
</div>



<div class="psyteachr_footer">
  
</div>
<script>

/* update total correct if #total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("total_correct")) {
    t.innerHTML =
      document.getElementsByClassName("correct").length + " of " +
      document.getElementsByClassName("solveme").length + " correct";
  }
}

/* solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "");
  }
  
  if (my_answer !== "" & real_answers.includes(my_answer)) {
    cl.add("correct");
  } else {
    cl.remove("correct");
  }
  update_total_correct();
}

window.onload = function() {
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('solution')) {
      buttons[i].onclick = b_func;
    }
  }
  
  /* set up solveme inputs */
  var solveme = document.getElementsByClassName("solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off"); 
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";
    
    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;
    
    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="network-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rstudio-cloud.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "lumen",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
